# Story 10.6: Error Playback Transcript

**Epic:** Dialog Roleplay Tutor
**Priority:** High
**Effort:** 1.5 hours
**Dependencies:** Story 10.5 (Professor Review)

---

## User Story

**As a** student
**I want to** review the full conversation with corrections highlighted
**So that** I can see exactly where I made mistakes

---

## Acceptance Criteria

- [ ] ErrorPlayback component shows full transcript
- [ ] User lines with errors highlighted
- [ ] Corrections shown inline with explanations
- [ ] Error categories labeled (grammar/vocab/syntax)
- [ ] Transcript scrollable with clean formatting
- [ ] "Start New Roleplay" button at bottom

---

## Technical Tasks

1. Reuse existing `ErrorPlayback` component
   - Import from `components/tutor/ErrorPlayback.tsx`
   - Pass session messages and errors
   - Adapt styling for dialog format

2. Update `DialogRoleplayPanel.tsx` - Review Stage
   - Display ErrorPlayback below ProfessorReview
   - Pass collected messages and errors
   - Format speaker labels (AI vs User character names)

3. Transcript formatting
   - AI messages: Show character name + text
   - User messages: Show "You (Character)" + text
   - Error annotations inline below user messages

---

## Transcript Display

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ Conversation Transcript         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Turn 1:                            â”‚
â”‚  Carlos: Hola, Â¿cÃ³mo estÃ¡s?        â”‚
â”‚                                     â”‚
â”‚  Turn 1:                            â”‚
â”‚  You (MarÃ­a): Estoy bien, gracias. â”‚
â”‚  âœ“ No errors                        â”‚
â”‚                                     â”‚
â”‚  Turn 2:                            â”‚
â”‚  Carlos: Â¿QuÃ© haces?                â”‚
â”‚                                     â”‚
â”‚  Turn 2:                            â”‚
â”‚  You (MarÃ­a): Yo voy al tienda.    â”‚
â”‚  âš ï¸ 1 error detected:               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Error: "al tienda"          â”‚   â”‚
â”‚  â”‚ Correction: "a la tienda"   â”‚   â”‚
â”‚  â”‚ Explanation: Use "la" with  â”‚   â”‚
â”‚  â”‚ feminine nouns              â”‚   â”‚
â”‚  â”‚ Category: Grammar           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  [More turns...]                    â”‚
â”‚                                     â”‚
â”‚  [Start New Roleplay]               â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Format

```typescript
interface TranscriptMessage {
  turnNumber: number
  role: 'ai' | 'user'
  speaker: string  // Character name
  content: string
  correction?: {
    hasErrors: boolean
    errors: ErrorDetail[]
  }
}
```

---

## Styling Guidelines

- **AI messages:** Light gray background, character name bold
- **User messages (no errors):** White background, green checkmark
- **User messages (errors):** Light yellow background, warning icon
- **Error details:** Indented box with border, expandable
- **Category badges:** Colored pills (red=grammar, blue=vocab, purple=syntax)

---

## Test Cases

1. **Full transcript:** All turns displayed in order
2. **Speaker labels:** Character names shown correctly
3. **Error highlighting:** Messages with errors visually distinct
4. **Error details:** All error info displayed clearly
5. **Category badges:** Correct colors for each category
6. **Scrolling:** Long transcripts scroll properly
7. **New roleplay button:** Button navigates back to selection stage

---

## Definition of Done

- [ ] ErrorPlayback component integrated
- [ ] Transcript displays correctly
- [ ] Error highlighting works
- [ ] Categories labeled properly
- [ ] "Start New Roleplay" button works
- [ ] All acceptance criteria met
- [ ] Manual testing with various error patterns
- [ ] Responsive on mobile
